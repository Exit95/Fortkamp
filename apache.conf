# Apache2 VirtualHost Configuration for Astro Static Site
# This file is used in the Docker container

ServerName localhost

<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    ServerName test.danapfel-digital.de
    DocumentRoot /usr/local/apache2/htdocs

    # Enable .htaccess overrides
    <Directory /usr/local/apache2/htdocs>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # DirectoryIndex
        DirectoryIndex index.html
        
        # Fallback for Astro routes
        FallbackResource /index.html
    </Directory>

    # Logging
    ErrorLog /proc/self/fd/2
    CustomLog /proc/self/fd/1 combined

    # Compression
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
    </IfModule>

    # Security Headers
    <IfModule mod_headers.c>
        Header set X-Content-Type-Options "nosniff"
        Header set X-Frame-Options "SAMEORIGIN"
        Header set X-XSS-Protection "1; mode=block"
    </IfModule>
</VirtualHost>

