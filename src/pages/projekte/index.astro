---
export const prerender = false;

import Layout from '../../layouts/Layout.astro';
import ProjectCard from '../../components/cards/ProjectCard.astro';
import CTA from '../../components/sections/CTA.astro';
import { getServices, getProjects } from '../../lib/data';

const projects = await getProjects();
const services = await getServices();

const serviceMap = Object.fromEntries(services.map((s: any) => [s.id, s.title]));
const sortedProjects = projects.sort((a: any, b: any) => new Date(b.completedAt).getTime() - new Date(a.completedAt).getTime());
---

<Layout
  title="Unsere Projekte"
  description="Entdecken Sie unsere abgeschlossenen Garten- und Landschaftsbauprojekte in Ahaus und Umgebung. Lassen Sie sich von unseren Referenzen inspirieren."
>
  <section class="pt-32 pb-16 bg-neutral-50">
    <div class="container">
      <div class="max-w-3xl">
        <h1 class="font-heading text-4xl md:text-5xl font-bold text-neutral-900 mb-6">
          Unsere Projekte
        </h1>
        <p class="text-lg text-neutral-600 leading-relaxed">
		          Hier sehen Sie Beispiele aus unserer Arbeit. Es sind Projekte aus Privatg채rten, von Gewerbefl채chen und aus Wohnanlagen. Wenn Sie Fragen haben, sagen wir Ihnen gern, wie wir das jeweilige Thema angehen.
        </p>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        {sortedProjects.map((project) => (
          <ProjectCard
            title={project.title}
            client={project.client}
            location={project.location}
            image={project.images[0]?.src}
            href={`/projekte/${project.slug}/`}
            services={project.services.map(s => serviceMap[s] || s)}
          />
        ))}
      </div>
    </div>
  </section>

		  <CTA
		    headline="Sollen wir 체ber Ihr Projekt sprechen?"
		    subheadline="Rufen Sie an oder schreiben Sie uns. Wir kl채ren kurz, worum es geht, und machen Ihnen ein Angebot."
		  />
</Layout>
